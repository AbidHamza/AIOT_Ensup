# Configuration Mosquitto pour AIoT Academy
# Environnement local/p√©dagogique uniquement
#
# üìö P√âDAGOGIE :
# Cette configuration est con√ßue pour l'apprentissage et le d√©veloppement local.
# Elle permet de comprendre les concepts MQTT sans complexit√© de s√©curit√© initiale.
# Pour la s√©curit√©, voir Room 6 - S√©curit√© AIoT

# ==============================================================================
# LISTENERS (Points d'√©coute)
# ==============================================================================

# √âcouter sur toutes les interfaces (localhost uniquement en local)
# Port 1883 : MQTT standard (non s√©curis√© - d√©veloppement uniquement)
listener 1883 0.0.0.0
protocol mqtt

# WebSocket pour dashboard/web
# Permet aux applications web de se connecter via WebSocket
listener 9001 0.0.0.0
protocol websockets

# NOTE: En production, ajouter:
# listener 8883 0.0.0.0
# protocol mqtt
# cafile /mosquitto/config/ca.crt
# certfile /mosquitto/config/server.crt
# keyfile /mosquitto/config/server.key

# ==============================================================================
# LOGGING (Journalisation)
# ==============================================================================
# Les logs sont essentiels pour comprendre ce qui se passe dans le broker
# Voir mqtt-log/README.md pour plus d'informations

# Destination des logs : fichier
log_dest file /mosquitto/log/mosquitto.log

# Types de logs √† enregistrer :
# - error : Erreurs critiques (toujours activ√©)
# - warning : Avertissements (probl√®mes non bloquants)
# - notice : Notifications importantes (connexions, d√©connexions)
# - information : Informations d√©taill√©es (messages, PUBLISH, etc.)
# - all : Tout (d√©veloppement uniquement, tr√®s verbeux)

log_type error
log_type warning
log_type notice
log_type information

# Format des timestamps dans les logs
log_timestamp true

# ==============================================================================
# PERSISTENCE (Persistance des donn√©es)
# ==============================================================================
# La persistence permet de sauvegarder :
# - Messages QoS 1/2 non encore d√©livr√©s
# - Sessions persistantes des clients (clean_session=false)
# - Messages retained (retenus)
# Voir mqtt-data/README.md pour plus d'informations

persistence true
persistence_location /mosquitto/data/

# ==============================================================================
# S√âCURIT√â (Configuration basique - d√©veloppement uniquement)
# ==============================================================================

# Permettre les connexions anonymes (p√©dagogique uniquement)
# ‚ö†Ô∏è DANGER EN PRODUCTION : D√©sactiver et utiliser l'authentification
allow_anonymous true

# ==============================================================================
# NOTES PRODUCTION (Configuration √† mettre en place pour la production)
# ==============================================================================
#
# 1. AUTHENTIFICATION :
#    allow_anonymous false
#    password_file /mosquitto/config/passwd
#    OU authentification par certificat (plus s√©curis√©)
#
# 2. TLS/SSL :
#    listener 8883
#    cafile /mosquitto/config/ca.crt
#    certfile /mosquitto/config/server.crt
#    keyfile /mosquitto/config/server.key
#    require_certificate true  # Pour mTLS (authentification mutuelle)
#
# 3. ACL (Access Control List) :
#    acl_file /mosquitto/config/acl
#    Permet de limiter l'acc√®s aux topics par utilisateur
#
# 4. LIMITES :
#    max_connections 1000
#    max_inflight_messages 100
#    max_queued_messages 1000
#
# 5. LOGS EN PRODUCTION :
#    Garder seulement error, warning, notice (pas information pour r√©duire la taille)
#
# Pour plus de d√©tails, voir Room 6 - S√©curit√© AIoT

